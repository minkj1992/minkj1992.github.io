<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noodp" />
    <title>Coursera Google IoT | minkj1992</title><meta name="Description" content="I love ocean, moon, sun, breeze, plant, philosopher, believer, Taoism, artist, masters, learning, reading, coding, talking, teaching, praying."><meta property="og:title" content="Coursera Google IoT" />
<meta property="og:description" content="This post is a summary of lectures
 taken in coursera on the topic of Google IoT core." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://minkj1992.github.io/coursera-gcp-iot/" /><meta property="og:image" content="https://minkj1992.github.io/images/profile3.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-13T21:18:00+09:00" />
<meta property="article:modified_time" content="2022-05-21T21:26:54+09:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://minkj1992.github.io/images/profile3.png"/>

<meta name="twitter:title" content="Coursera Google IoT"/>
<meta name="twitter:description" content="This post is a summary of lectures
 taken in coursera on the topic of Google IoT core."/>
<meta name="application-name" content="minkj1992">
<meta name="apple-mobile-web-app-title" content="minkj1992"><meta name="theme-color" content="#DB6B97"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/images/favicon.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://minkj1992.github.io/coursera-gcp-iot/" /><link rel="prev" href="https://minkj1992.github.io/gevent/" /><link rel="next" href="https://minkj1992.github.io/pubsub/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Coursera Google IoT",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/minkj1992.github.io\/coursera-gcp-iot\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "https:\/\/minkj1992.github.io\/images\/profile2.jpeg",
                            "width":  1078 ,
                            "height":  1082 
                        }],"genre": "posts","keywords": "dev, gcp, iot, coursera","wordcount":  1734 ,
        "url": "https:\/\/minkj1992.github.io\/coursera-gcp-iot\/","datePublished": "2022-05-13T21:18:00+09:00","dateModified": "2022-05-21T21:26:54+09:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "minkj1992","logo": {
                    "@type": "ImageObject",
                    "url": "https:\/\/minkj1992.github.io\/images\/profile3.png",
                    "width":  1362 ,
                    "height":  1868 
                }},"author": {
                "@type": "Person",
                "name": "leoo.j"
            },"description": ""
    }
    </script></head>

<body data-header-desktop="auto"
    data-header-mobile="auto"><script
        type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('light' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'light' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

    <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="minkj1992"><span class="header-title-pre"><span style='color: Mediumslateblue;'><</span></span><span id="id-1" class="typeit"></span><span class="header-title-post"><span style='color: Mediumslateblue;'>/></span></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="https://github.com/minkj1992/love" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="minkj1992"><span class="header-title-pre"><span style='color: Mediumslateblue;'><</span></span><span id="id-2" class="typeit"></span><span class="header-title-post"><span style='color: Mediumslateblue;'>/></span></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="https://github.com/minkj1992/love" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
            <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Coursera Google IoT</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://github.com/minkj1992" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>leoo.j</a>
</span>&nbsp;<span class="post-category">included in <a href="/categories/iot/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>iot</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2022-05-13">2022-05-13</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;1734 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;9 minutes&nbsp;</div>
        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/boston_dynamics.png"
        data-srcset="/images/boston_dynamics.png, /images/boston_dynamics.png 1.5x, /images/boston_dynamics.png 2x"
        data-sizes="auto"
        alt="/images/boston_dynamics.png"
        title="/images/boston_dynamics.png" /></div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#day-1--2">Day 1 ~ 2</a>
      <ul>
        <li><a href="#what-is-iot">What is IoT?</a></li>
        <li><a href="#iot-cloud">IoT cloud</a></li>
        <li><a href="#challenges-in-iot">Challenges in IoT</a></li>
        <li><a href="#iot-architecture">IoT Architecture</a></li>
      </ul>
    </li>
    <li><a href="#day-3">Day 3</a>
      <ul>
        <li><a href="#types-of-sensors">Types of sensors</a></li>
        <li><a href="#devices">Devices</a></li>
        <li><a href="#device-commands">Device commands</a></li>
        <li><a href="#defining-devices">Defining devices</a></li>
        <li><a href="#google-iot-developer-prototyping-kits">Google IoT developer prototyping kits</a></li>
        <li><a href="#mqtt-protocol">MQTT protocol</a></li>
        <li><a href="#http-protocl">HTTP protocl</a></li>
        <li><a href="#comparison-of-mqtt-and-http-general-features">Comparison of MQTT and HTTP general features</a></li>
      </ul>
    </li>
    <li><a href="#day4-google-clouds-iot-platform">Day4: Google Cloud&rsquo;s IoT Platform</a>
      <ul>
        <li><a href="#pubsub">Pub/Sub</a></li>
        <li><a href="#cloud-iot-core">Cloud IoT Core</a>
          <ul>
            <li><a href="#cloud-iot-core-fully-integrates-your-devices">Cloud IoT Core fully integrates your devices</a></li>
            <li><a href="#registration-connects-devices-to-google-iot-cloud">Registration connects devices to Google IoT Cloud</a></li>
            <li><a href="#protocol-bridges">Protocol bridges</a></li>
          </ul>
        </li>
        <li><a href="#cloud-storage">Cloud Storage</a></li>
        <li><a href="#dataflow">Dataflow</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>This post is a summary of <a href="https://www.coursera.org/learn/iiot-google-cloud-platform/lecture/sMtHo/industrial-iot-on-google-cloud" target="_blank" rel="noopener noreffer">lectures</a>
 taken in coursera on the topic of <code>Google IoT core</code>.</p>
<br />
<h2 id="day-1--2">Day 1 ~ 2</h2>
<h3 id="what-is-iot">What is IoT?</h3>
<p>Internet of Things is a sprawling set of technologies and use that has no clear, single definition.</p>
<p>But one workable view frames IoT as the use of network-connected devices, embedded in the physical env, to improve some existing process or to enable a new scenario not previously possible.</p>
<h3 id="iot-cloud">IoT cloud</h3>
<p>The general structure of an IoT cloud</p>
<ol>
<li>Devices
<ol>
<li>gathering data</li>
<li>performing an action</li>
<li>interact with users</li>
</ol>
</li>
<li>Gateway
<ol>
<li>A gateway ensures that devices are securely connected to the cloud. It can be a cell phone.</li>
<li>It controls messaging between the device and the cloud</li>
</ol>
</li>
<li>Cloud
<ul>
<li>u na mean</li>
</ul>
</li>
</ol>
<h3 id="challenges-in-iot">Challenges in IoT</h3>
<p>When designing an IoT network, below topics should be considered.</p>
<ul>
<li>connectivity
<ul>
<li>At present IoT relies on a server/client model to authenticate, authorize and connect devices to nodes in the network</li>
<li>It will become unworkable as numbers grow to the millions and billions per network.</li>
<li>In the future, off-loading tasks to the edge will become important. This means that IoT networks will need devices capable of handling data analysis, ML, and data gathering.</li>
</ul>
</li>
<li>brownfield deployment(legacy infra)
<ul>
<li>Companies will need to confront the task of integrating new devices and technologies into existing networks.</li>
</ul>
</li>
<li>security and compilance</li>
<li>non-standard communication protocol
<ul>
<li>Dealing with non-standard communication protocol will
increase in importance as networks need to handle
ever-increasing amounts of data from sensors. Data
handling, processing, and storing will increase as data input
loads increase, while at the same time, the value of data
increases with the size, depth, and frequency of data
available to data analytics.</li>
</ul>
</li>
<li>IT/OT convergence
<ul>
<li>IT has traditionally been data-centric</li>
<li>OT has been used to monitor events.</li>
</ul>
</li>
<li>get actionable intelligence from data.</li>
</ul>
<h3 id="iot-architecture">IoT Architecture</h3>
<p>IoT architecturesmust be capable of scaling connectivity of devices, data ingestion, data processing, and data storage.
They must be able to do this quickly while still producing real-time data insights.</p>
<p>To migrate this demand, distributed computing known as fog or edge computing is gaining popularity. The edge refers to the geographic distribution of computing nodes in the network as sIoT devices, which are at the &ldquo;edge&rdquo; of a network. This in turn increases the demand for devices that are capable of cleaning, processing and analyzing data locally. The result is that only cleaned metadata is sent to the cloud.</p>
<p>An asynchronous, scalable communication stack is crucial in bidirectional communication with devices.</p>
<p><a href="https://k21academy.com/google-cloud/cloud-sql-vs-cloud-spanner/" target="_blank" rel="noopener noreffer">https://k21academy.com/google-cloud/cloud-sql-vs-cloud-spanner/</a>
</p>
<h2 id="day-3">Day 3</h2>
<h3 id="types-of-sensors">Types of sensors</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/types_of_sensors.png"
        data-srcset="/images/types_of_sensors.png, /images/types_of_sensors.png 1.5x, /images/types_of_sensors.png 2x"
        data-sizes="auto"
        alt="/images/types_of_sensors.png"
        title="/images/types_of_sensors.png" /></p>
<h3 id="devices">Devices</h3>
<p>A &ldquo;Thing&rdquo; in the &ldquo;Internet of Things&rdquo; is a
processing unit that is capable of connecting to the internet and exchanging data with the cloud.</p>
<p>Devices are often called &ldquo;smart devices&rdquo; or
&ldquo;connected devices.&rdquo; They communicate two
types of data: telemetry and state.</p>
<p><code>Device information</code> is mainly composed of three types as follows.</p>
<ol>
<li>
<p>Device metadata: Most metadata rarely, if ever, changes.</p>
<ul>
<li>Identifier (ID) -An identifier that uniquely identifies a device.</li>
<li>Class or type</li>
<li>Model</li>
<li>Revision</li>
<li>Date manufactured</li>
<li>Hardware serial numbe</li>
</ul>
</li>
<li>
<p>Telemetry: Data collected by the device is called telemetry</p>
<ol>
<li>Telemetry is read-only data about the environment</li>
<li>usually collected
through sensors</li>
<li>e.g. Temperature(35.4oC)</li>
</ol>
</li>
<li>
<p>State information</p>
<ol>
<li>Describes the current
status of the device, not of the
environment</li>
<li>can be read/write. It is updated, but usually not frequently.</li>
</ol>
</li>
</ol>
<h3 id="device-commands">Device commands</h3>
<ul>
<li>
<p><code>Commands</code> are actions performed by a device. So tye should include a time-to-live(TTL) or other expiration value</p>
</li>
<li>
<p><code>Operational information</code> is data that&rsquo;s most relevant to the operation of the device as opposed to the business application.</p>
<ul>
<li>This might include things such as CPU operating temperature and battery state.</li>
<li>it has short-term value to help maintain the os</li>
<li><strong>It can be transmitted as <code>telemetry</code> or <code>state data</code></strong></li>
</ul>
</li>
</ul>
<h3 id="defining-devices">Defining devices</h3>
<p>For example, consider a project for monitoring the temperature in hotel rooms. Each room
has three sensors: one near the floor, one near the bed, and one near the ceiling.</p>
<p>option1</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span><span class="err">deviceID:</span> <span class="nt">&#34;dh28dslkja&#34;</span><span class="p">,</span> <span class="nt">&#34;location&#34;</span><span class="p">:</span> <span class="s2">&#34;floor&#34;</span><span class="p">,</span> <span class="nt">&#34;room&#34;</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span> <span class="nt">&#34;temp&#34;</span><span class="p">:</span> <span class="mi">22</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="err">deviceID:</span> <span class="nt">&#34;8d3kiuhs8a&#34;</span><span class="p">,</span> <span class="nt">&#34;location&#34;</span><span class="p">:</span> <span class="s2">&#34;bedside&#34;</span><span class="p">,</span> <span class="nt">&#34;room&#34;</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span> <span class="nt">&#34;temp&#34;</span><span class="p">:</span> <span class="mi">24</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="err">deviceID:</span> <span class="nt">&#34;kd8s8hh3o&#34;</span><span class="p">,</span> <span class="nt">&#34;location&#34;</span><span class="p">:</span> <span class="s2">&#34;ceiling&#34;</span><span class="p">,</span> <span class="nt">&#34;room&#34;</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span> <span class="nt">&#34;temp&#34;</span><span class="p">:</span> <span class="mi">20</span> <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>option2</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span><span class="err">deviceID:</span> <span class="nt">&#34;dh28dslkja&#34;</span><span class="p">,</span> <span class="nt">&#34;room&#34;</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span> <span class="nt">&#34;temp_floor&#34;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="nt">&#34;temp_bedside&#34;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span> <span class="nt">&#34;temp_ceiling&#34;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="nt">&#34;average_temp&#34;</span><span class="p">:</span> <span class="mi">22</span> <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="google-iot-developer-prototyping-kits">Google IoT developer prototyping kits</h3>
<p>Google works with partners to build device starter kits that make connecting to Google Cloud IoT Platform easy for developers. At this time, Google has partnered with fourteen companies to offer a wide variety of <a href="https://d3c33hcgiwev3.cloudfront.net/r0yj9QAaRl2Mo_UAGjZdFw_354538e7a78d48d79048afcdd3b1bea1_10.-Google-IoT-Developer-Prototyping-Kits.pdf?Expires=1653091200&amp;Signature=gkcQBVgHOXNjN3ueT4CtMIMAfaZYDouIdi8G7RHaBCi~hhNKrI~c483dhbf~UtRPeF5ZBR6qryCvRXNzdh0PYQk1ih2o3QgmhAMqLqCuCjK9DCWsG2tfVSVW--04PgzzrvFnK-GpIKiv8SHze8Xwzkif~fFax-WAZ5j-1euA7W4_&amp;Key-Pair-Id=APKAJLTNE6QMUY6HBC5A" target="_blank" rel="noopener noreffer">IoT developer prototyping kits</a>
.</p>
<h3 id="mqtt-protocol">MQTT protocol</h3>
<blockquote>
<p><a href="https://cloud.google.com/iot/docs/concepts/protocols" target="_blank" rel="noopener noreffer">https://cloud.google.com/iot/docs/concepts/protocols</a>
</p>
</blockquote>
<p>MQTT is an industry-standard IoT protocol (Message Queue Telelmetry Transport).</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/mqtt.png"
        data-srcset="/images/mqtt.png, /images/mqtt.png 1.5x, /images/mqtt.png 2x"
        data-sizes="auto"
        alt="/images/mqtt.png"
        title="/images/mqtt.png" /></p>
<p>Messages include the topic in the message, which is used for routing information by the broker. <strong>This means that subscribers do not need to know the publisher, because all communication is done through messages</strong></p>
<ul>
<li>Messages are pushed to subscribers, so there must be an open TCP connection to the broker (subscriber &lt;-&gt; broker)
<ul>
<li>If the connection is broken, the broker can hold messages for later transmission.</li>
</ul>
</li>
</ul>
<h3 id="http-protocl">HTTP protocl</h3>
<blockquote>
<p>HTTP is a &ldquo;connectionless&rdquo; protocol: with the HTTP bridge, devices do not maintain a connection
to the cloud.</p>
</blockquote>
<p>In connectionless communication, client requests are sent without having to first check that the recipient is available. Therefore devices have no way of knowing whether they are in a conversation with the server, and vice versa.</p>
<p><strong>This means some of the features that Cloud IoT Core provides, for example, last Heartbeat detected, will not be available with an HTTP connection.</strong></p>
<h3 id="comparison-of-mqtt-and-http-general-features">Comparison of MQTT and HTTP general features</h3>
<blockquote>
<p>MQTT is considered to be data focused, while HTTP is document focused. Which means <strong>MQTT is better suited to the rigors of IoT</strong>.</p>
</blockquote>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/mqtt_vs_http.png"
        data-srcset="/images/mqtt_vs_http.png, /images/mqtt_vs_http.png 1.5x, /images/mqtt_vs_http.png 2x"
        data-sizes="auto"
        alt="/images/mqtt_vs_http.png"
        title="/images/mqtt_vs_http.png" /></p>
<p>In addition, MQTT has three levels of service(QoS)</p>
<ol>
<li>At most once.
<ul>
<li>Guarantees at least one attempt at delivery, (no guarantee of delivery).</li>
</ul>
</li>
<li>At least once.
<ul>
<li>Guarantees the message will be delivered at least once.</li>
</ul>
</li>
<li>Exactly once.
<ul>
<li>Guarantees the message is delivered only once.</li>
</ul>
</li>
</ol>
<p>MQTT also has</p>
<ul>
<li><code>Last will and testament</code>(유언, <code>LWT</code>). If a client (ie device) is disconnected unexpectedly, the subscribers will be notified by the MQTT broker.</li>
<li><strong>Retained(보관) messages. New subscribers will get an immediate status update.</strong></li>
</ul>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>LWT<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>통신에서 중요하지만 구현이 까다로운 문제로 &ldquo;상대방이 예상치 못한 상황으로 인하여 접속이 끊어졌을때&quot;의 처리가 있다.</p>
<p>그래서 전통적 방식으로는 자신의 생존 여부를 계속 ping을 통해 서버가 물어보고 timeout 시간안에 pong이 안올 경우 서버에서 접속 종료를 인식하는 번거로운 방식을 취하는데,</p>
<p><strong>MQTT의 경우 subscribe 시점에서 자신이 접속 종료가 되었을 때 특정 topic으로 지정한 메시지를 보내도록 미리 설정할 수 있다.
이를 LWT(Last will and testament) 라고 한다. 선언을 먼저하고 브로커가 처리하게 하는 방식인 것이다.</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="err">$</span> <span class="n">mqtt</span> <span class="n">help</span> <span class="n">subscribe</span>
</span></span><span class="line"><span class="cl"><span class="n">Usage</span><span class="p">:</span> <span class="n">mqtt</span> <span class="n">subscribe</span> <span class="p">[</span><span class="n">opts</span><span class="p">]</span> <span class="p">[</span><span class="n">topic</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Available</span> <span class="n">options</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span> <span class="n">중략</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">--</span><span class="n">will</span><span class="o">-</span><span class="n">topic</span> <span class="n">TOPIC</span>    <span class="n">the</span> <span class="n">will</span> <span class="n">topic</span>
</span></span><span class="line"><span class="cl">  <span class="o">--</span><span class="n">will</span><span class="o">-</span><span class="n">message</span> <span class="n">BODY</span>   <span class="n">the</span> <span class="n">will</span> <span class="n">message</span>
</span></span><span class="line"><span class="cl">  <span class="o">--</span><span class="n">will</span><span class="o">-</span><span class="n">qos</span> <span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span>      <span class="n">the</span> <span class="n">will</span> <span class="n">qos</span>
</span></span><span class="line"><span class="cl">  <span class="o">--</span><span class="n">will</span><span class="o">-</span><span class="n">retain</span>         <span class="n">send</span> <span class="n">a</span> <span class="n">will</span> <span class="n">retained</span> <span class="n">message</span>
</span></span></code></pre></td></tr></table>
</div>
</div></div>
        </div>
    </div>
<p>Both MQTT and HTTP use pub key(asymmetric) device authentication, and JWT. <a href="https://cloud.google.com/iot/docs/concepts/device-security" target="_blank" rel="noopener noreffer">In more detail</a>
</p>
<h2 id="day4-google-clouds-iot-platform">Day4: Google Cloud&rsquo;s IoT Platform</h2>
<blockquote>
<p>This section covers the ingest and process stages of IoT architecture.</p>
</blockquote>
<p>Learning Objectives</p>
<ul>
<li>Create Cloud IoT registries and devices</li>
<li>Create Pub/Sub topics and sobscriptions</li>
<li>Create and manage Cloud Storage buckets</li>
<li>Manage device credentials and access control</li>
<li>Create a Dataflow pipeline</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/gcp_overview.png"
        data-srcset="/images/gcp_overview.png, /images/gcp_overview.png 1.5x, /images/gcp_overview.png 2x"
        data-sizes="auto"
        alt="/images/gcp_overview.png"
        title="/images/gcp_overview.png" /></p>
<h3 id="pubsub">Pub/Sub</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/pubsub1.png"
        data-srcset="/images/pubsub1.png, /images/pubsub1.png 1.5x, /images/pubsub1.png 2x"
        data-sizes="auto"
        alt="/images/pubsub1.png"
        title="/images/pubsub1.png" /></p>
<ul>
<li>The Subscriber sends the acknowledgement to the Subscription</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/pubsub2.png"
        data-srcset="/images/pubsub2.png, /images/pubsub2.png 1.5x, /images/pubsub2.png 2x"
        data-sizes="auto"
        alt="/images/pubsub2.png"
        title="/images/pubsub2.png" />
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/pubsub3.png"
        data-srcset="/images/pubsub3.png, /images/pubsub3.png 1.5x, /images/pubsub3.png 2x"
        data-sizes="auto"
        alt="/images/pubsub3.png"
        title="/images/pubsub3.png" />
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/pubsub4.png"
        data-srcset="/images/pubsub4.png, /images/pubsub4.png 1.5x, /images/pubsub4.png 2x"
        data-sizes="auto"
        alt="/images/pubsub4.png"
        title="/images/pubsub4.png" /></p>
<p>Use Cases</p>
<ul>
<li>Balancing workloads in network clusters</li>
<li><strong>Implementing async workflows</strong></li>
<li><strong>Distirbuting event notifications</strong></li>
<li>Refreshing distributed caches</li>
<li>Logging to multiple systems</li>
<li><strong>Data streaming from various processes or devices</strong></li>
<li>Reliabiltiy(신뢰할 수 있음) improvement</li>
</ul>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>FYI use case<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>Balancing workloads in network clusters, for example, a large queue of tasks can be efficiently distributed among multiple workers such as Google Compute Engine instances.</li>
<li>Implementing asynchronous workflows, for example, an order processing application can place an order on a topic from which it can be processed by one or more workers.</li>
<li>Distributing event notifications, for example, a service that accepts user sign-ups can send notifications whenever a new user registers and a downstream services can subscribe to receive notifications of the event.</li>
<li>Refreshing distributed caches, for example, an application can publish invalidation(캐시 무효화) events to update the IDs of objects that have changed.</li>
<li>Logging into multiple systems, for example, a Google Compute Engine instance can write logs to the monitoring system, to a database for later querying and so on.</li>
<li>Data streaming from various processes or devices, for example, a residential(주거, 숙박) sensor can stream data to backend services hosted in the Cloud.</li>
<li>Also, reliability improvement, for example, a single-zone Compute Engine service can operate in additional zones by subscribing to a common topic to recover from failures in a zone or region.</li>
</ul>
</div>
        </div>
    </div>
<ul>
<li><a href="https://www.cloudskillsboost.google/catalog?keywords=Google%20Cloud%20Pub%2FSub&amp;qlcampaign=yt18-gsp095-11078&amp;ransack=true&amp;utm_source=youtube&amp;utm_campaign=ytcc110&amp;utm_medium=video" target="_blank" rel="noopener noreffer">gcp pubsub labs</a>
 in practice
<ul>
<li><a href="https://minkj1992.github.io/pubsub/" target="_blank" rel="noopener noreffer">https://minkj1992.github.io/pubsub/</a>
</li>
</ul>
</li>
</ul>
<h3 id="cloud-iot-core">Cloud IoT Core</h3>
<p>Full Ingest and Process and Analyze process
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/ingest_process_analyze.png"
        data-srcset="/images/ingest_process_analyze.png, /images/ingest_process_analyze.png 1.5x, /images/ingest_process_analyze.png 2x"
        data-sizes="auto"
        alt="/images/ingest_process_analyze.png"
        title="/images/ingest_process_analyze.png" /></p>
<p>Cloud IoT combines both protocol bridge and device manager.</p>
<ul>
<li>Protocol Bridge
<ul>
<li>MQTT protocol with single Global endpoint(mqtt.googleapis.com)</li>
<li>Automatic load balancing</li>
<li>Global data access with Pub/Sub</li>
</ul>
</li>
<li>Device Manager
<ul>
<li>Configure individual devices</li>
<li>Update and control devices</li>
<li>Role level access control (authrization)</li>
<li>Console and APIs for device deployment and monitoring</li>
</ul>
</li>
</ul>
<h4 id="cloud-iot-core-fully-integrates-your-devices">Cloud IoT Core fully integrates your devices</h4>
<ol>
<li>make decision</li>
</ol>
<ul>
<li><strong>Device telemetry data is forwarded to a Pub/Sub topic, which can then be used to trigger Cloud Functions. You can also perform streaming analysis with Dataflow or custom analysis with your own subscribers.</strong></li>
</ul>
<ol start="2">
<li>secure</li>
</ol>
<ul>
<li>Cloud IoT uses automatic load balancing and horizontal scaling to ensure smooth data ingestion under any condition. Cloud IoT Core follows industry-standard security protocols.</li>
</ul>
<h4 id="registration-connects-devices-to-google-iot-cloud">Registration connects devices to Google IoT Cloud</h4>
<p>tl;dr</p>
<ul>
<li><code>Device registry</code>: belong to cloud project so single region</li>
<li><code>Device</code>: belong to device registry so single region (<strong>registry : device = 1 : n</strong>)</li>
<li><code>topic</code>: global single endpoint (belong to pubsub)</li>
</ul>
<hr>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/device_registry_iot.png"
        data-srcset="/images/device_registry_iot.png, /images/device_registry_iot.png 1.5x, /images/device_registry_iot.png 2x"
        data-sizes="auto"
        alt="/images/device_registry_iot.png"
        title="/images/device_registry_iot.png" /></p>
<ol>
<li>
<p>In order for a device to connect, it must first be registered in the device manager. The device
manager lets you create and configure device registries and the devices within them.</p>
</li>
<li>
<p>A device registry is a container of devices. When you create a device registry, you select which
protocols to enable: MQTT, HTTP, or both.</p>
</li>
</ol>
<ul>
<li>Each device registry is created in a specific cloud region and belongs to a cloud project.</li>
<li>A registry is identified in the cloudiot.googleapis.com service by its full name.</li>
<li>as <strong><code>projects/{project-id}/locations/{cloud-region}/registries/{registry-id}</code></strong></li>
</ul>
<ol start="3">
<li>The device registry is configured with one or more Pub/Sub topics to which telemetry
events are published for all devices in that registry.</li>
<li>A single topic can be used to collect
data across all regions.</li>
<li>Cloud monitoring is automatically enabled for each registry.</li>
</ol>
<p>For details, see<a href="https://cloud.google.com/iot/docs/reference/cloudiot/rest/v1/projects.locations.registries" target="_blank" rel="noopener noreffer">DeviceRegistry resource reference</a>
</p>
<h4 id="protocol-bridges">Protocol bridges</h4>
<blockquote>
<p>Devices communicate with Cloud IoT Core across a &ldquo;bridge&rdquo; — either the MQTT bridge or the HTTP bridge.</p>
</blockquote>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/protocol_bridges.png"
        data-srcset="/images/protocol_bridges.png, /images/protocol_bridges.png 1.5x, /images/protocol_bridges.png 2x"
        data-sizes="auto"
        alt="/images/protocol_bridges.png"
        title="/images/protocol_bridges.png" /></p>
<p>Note that GCP Cloud IoT Core supports HTTP 1.1 only.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/protocol_bridge_vs.png"
        data-srcset="/images/protocol_bridge_vs.png, /images/protocol_bridge_vs.png 1.5x, /images/protocol_bridge_vs.png 2x"
        data-sizes="auto"
        alt="/images/protocol_bridge_vs.png"
        title="/images/protocol_bridge_vs.png" /></p>
<h3 id="cloud-storage">Cloud Storage</h3>
<h3 id="dataflow">Dataflow</h3></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2022-05-21&nbsp;<a class="git-hash" href="https://github.com/minkj1992/love/commit/332df4caa77462be9ff83cd033a4b3221718a80c" target="_blank" title="commit by minkj1992(minkj1992@gmail.com) 332df4caa77462be9ff83cd033a4b3221718a80c: rebuilding site Sat May 21 21:26:54 KST 2022">
                                    <i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>332df4c</a></span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/coursera-gcp-iot/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://minkj1992.github.io/coursera-gcp-iot/" data-title="Coursera Google IoT" data-hashtags="dev,gcp,iot,coursera"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://minkj1992.github.io/coursera-gcp-iot/" data-hashtag="dev"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://minkj1992.github.io/coursera-gcp-iot/" data-title="Coursera Google IoT"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="https://minkj1992.github.io/coursera-gcp-iot/" data-title="Coursera Google IoT"><i data-svg-src="/lib/simple-icons/icons/line.min.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="https://minkj1992.github.io/coursera-gcp-iot/" data-title="Coursera Google IoT" data-image="/images/boston_dynamics.png"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/dev/">dev</a>,&nbsp;<a href="/tags/gcp/">gcp</a>,&nbsp;<a href="/tags/iot/">iot</a>,&nbsp;<a href="/tags/coursera/">coursera</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/gevent/" class="prev" rel="prev" title="Gevent"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Gevent</a>
            <a href="/pubsub/" class="next" rel="next" title="Google Cloud Pub/Sub">Google Cloud Pub/Sub<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><div id="utterances"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://utteranc.es/">Utterances</a>.
            </noscript></div></article></div>
        </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.98.0">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2021 - 2022</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://github.com/minkj1992" target="_blank">Minwook Je</a></span></div>
        </div>
    </footer></div>

    <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
            <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
        </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
            <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
        </a>
    </div><link rel="stylesheet" href="/lib/lightgallery/lightgallery.min.css"><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/katex/copy-tex.min.css"><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/lazysizes/ls.parent-fit.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lightgallery.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-thumbnail.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lg-zoom.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/typeit/typeit.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/auto-render.min.js"></script><script type="text/javascript" src="/lib/katex/copy-tex.min.js"></script><script type="text/javascript" src="/lib/katex/mhchem.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{"utterances":{"darkTheme":"github-dark","issueTerm":"pathname","label":"✨💬✨","lightTheme":"github-light","repo":"minkj1992/minkj1992.github.io"}},"data":{"id-1":"The Serious","id-2":"The Serious"},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":50,"type":"lunr"},"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"id-1":["id-1"],"id-2":["id-2"]},"duration":-1,"speed":100}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>

</html>